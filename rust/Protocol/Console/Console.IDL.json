{
    "protocol": {
        "name": "console",
        "version": 1
    },
    "enums": {
        "KeyCode": [ "A", "B", "C", "D", "E" ],
        "PointerButton": [ "Left", "Right", "Middle" ]
    },
    "types": {
        "Color": {
            "fields": {
                "alpha": {
                    "type": "u8"
                },
                "red": {
                    "type": "u8"
                },
                "green": {
                    "type": "u8"
                },
                "blue": {
                    "type": "u8"
                }
            }
        },
        "Point": {
            "fields": {
                "x": {
                    "type": "i64"
                },
                "y": {
                    "type": "i64"
                }
            }
        },
        "Size": {
            "fields": {
                "width": {
                    "type": "u64"
                },
                "height": {
                    "type": "u64"
                }
            }
        },
        "Image": {
            "fields": {
                "size": {
                    "type": "Size"
                },
                "pixels": {
                    "type": "Color",
                    "array": true
                }
            }
        },
        "ImagePatch": {
            "fields": {
                "image": {
                    "type": "Image"
                },
                "position": {
                    "type": "Point"
                }
            }
        },
        "Object": {
            "fields": {
                "name": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                }
            }
        },
        "MapField": {
            "fields": {
                "name": {
                    "type": "string"
                },
                "value": {
                    "type": "i64|bool|string|none"
                }
            }
        },
        "Map": {
            "inherits_from": "Object",
            "fields": {
                "fields": {
                    "type": "MapField",
                    "array": true
                }
            }
        },
        "Table": {
            "inherits_from": "Object",
            "fields": {
                "columns": {
                    "type": "string",
                    "array": true
                },
                "rows": {
                    "type": "Map",
                    "array": true
                }
            }
        }
    },
    "from_client": {
        "get_capabilities": {
            "type": "call",
            "returns": {
                "is_framebuffer": {
                    "type": "bool"
                },
                "framebuffer_size": {
                    "type": "Size"
                },
                "text_size": {
                    "type": "Size"
                }
            }
        },
        "set_text_color": {
            "type": "call",
            "parameters": {
                "foreground": {
                    "type": "Color"
                },
                "background": {
                    "type": "Color"
                }
            }
        },
        "move_text_cursor": {
            "type": "call",
            "parameters": {
                "position": {
                    "type": "Point"
                }
            }
        },
        "debug_draw_image": {
            "type": "call",
            "parameters": {
                "image": {
                    "type": "Image"
                }
            }
        },
        "draw_image_patches": {
            "type": "call",
            "parameters": {
                "image_patches": {
                    "type": "ImagePatch",
                    "array": true
                }
            }
        },
        "write_text": {
            "type": "call",
            "parameters": {
                "text": {
                    "type": "string"
                }
            }
        },
        "write_objects": {
            "type": "call",
            "parameters": {
                "objects": {
                    "type": "Table|Map",
                    "array": true
                }
            }
        }
    },
    "from_server": {
        "key_pressed": {
            "type": "event",
            "parameters": {
                "key_code": {
                    "type": "KeyCode"
                }
            }
        },
        "key_released": {
            "type": "event",
            "parameters": {
                "key_code": {
                    "type": "KeyCode"
                }
            }
        },
        "pointer_moved": {
            "type": "single_event",
            "parameters": {
                "position": {
                    "type": "Point"
                }
            }
        },
        "pointer_pressed": {
            "type": "event",
            "parameters": {
                "position": {
                    "type": "Point"
                },
                "buttons": {
                    "type": "PointerButton",
                    "array": true
                }
            }
        },
        "pointer_released": {
            "type": "event",
            "parameters": {
                "position": {
                    "type": "Point"
                },
                "buttons": {
                    "type": "PointerButton",
                    "array": true
                }
            }
        },
        "size_changed": {
            "type": "event",
            "parameters": {
                "framebuffer_size": {
                    "type": "Size"
                },
                "text_size": {
                    "type": "Size"
                }
            }
        }
    }
}
